## قراءة ملف (Reading a File)

سنقوم الآن بإضافة وظيفة لقراءة الملف المحدد في وسيط (argument) `file_path`. أولاً، نحتاج إلى ملف عينة لاختباره: سنستخدم ملفاً يحتوي على كمية صغيرة من النص عبر عدة أسطر مع بعض الكلمات المتكررة. تحتوي القائمة 12-3 على قصيدة لإميلي ديكنسون (Emily Dickinson) ستعمل بشكل جيد! أنشئ ملفاً يسمى _poem.txt_ في المستوى الجذر لمشروعك، وأدخل قصيدة "I’m Nobody! Who are you?".

<Listing number="12-3" file-name="poem.txt" caption="قصيدة لإميلي ديكنسون تشكل حالة اختبار جيدة.">

```text
{{#include ../listings/ch12-an-io-project/listing-12-03/poem.txt}}
```

</Listing>

مع وجود النص في مكانه، قم بتحرير _src/main.rs_ وأضف كوداً لقراءة الملف، كما هو موضح في القائمة 12-4.

<Listing number="12-4" file-name="src/main.rs" caption="قراءة محتويات الملف المحدد بواسطة الوسيط الثاني">

```rust,should_panic,noplayground
{{#rustdoc_include ../listings/ch12-an-io-project/listing-12-04/src/main.rs:here}}
```

</Listing>

أولاً، نقوم باستيراد جزء ذي صلة من المكتبة القياسية (standard library) باستخدام جملة `use`: نحتاج إلى `std::fs` للتعامل مع الملفات.

في `main` ، تأخذ الجملة الجديدة `fs::read_to_string` الـ `file_path` ، وتفتح ذلك الملف، وتُرجع قيمة من نوع `std::io::Result<String>` تحتوي على محتويات الملف.

بعد ذلك، نضيف مرة أخرى جملة `println!` مؤقتة تطبع قيمة `contents` بعد قراءة الملف حتى نتمكن من التحقق من أن البرنامج يعمل حتى الآن.

دعونا نشغل هذا الكود مع أي سلسلة نصية (string) كأول وسيط لواجهة الأوامر (لأننا لم ننفذ جزء البحث بعد) وملف _poem.txt_ كوسيط ثانٍ:

```console
{{#rustdoc_include ../listings/ch12-an-io-project/listing-12-04/output.txt}}
```

رائع! قام الكود بقراءة محتويات الملف ثم طباعتها. لكن الكود به بعض العيوب. في الوقت الحالي، تمتلك دالة `main` مسؤوليات متعددة: بشكل عام، تكون الدوال أوضح وأسهل في الصيانة إذا كانت كل دالة مسؤولة عن فكرة واحدة فقط. المشكلة الأخرى هي أننا لا نعالج الأخطاء (handling errors) بشكل جيد كما يمكننا. لا يزال البرنامج صغيراً، لذا فإن هذه العيوب ليست مشكلة كبيرة، ولكن مع نمو البرنامج، سيكون من الصعب إصلاحها بشكل نظيف. من الممارسات الجيدة البدء في إعادة الهيكلة (refactoring) في وقت مبكر عند تطوير البرنامج لأنه من الأسهل بكثير إعادة هيكلة كميات أصغر من الكود. سنفعل ذلك بعد ذلك.
